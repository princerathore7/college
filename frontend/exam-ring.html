<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exam Ring — Mentor Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body { font-family: 'Inter', sans-serif; background:#f3f4f6; margin:0; }
header { background:#0b3c5d; color:#fff; padding:1rem 2rem; text-align:center; }
main { max-width:900px; margin:2rem auto; padding:1.5rem; background:#fff; border-radius:12px; box-shadow:0 6px 16px rgba(0,0,0,0.1); }
h2 { margin-top:0; color:#0b3c5d; }

label { display:block; margin-top:0.8rem; font-weight:600; }
input, select {
  width:100%;
  padding:0.6rem;
  margin-top:0.2rem;
  border-radius:6px;
  border:1px solid #ccc;
}

button {
  margin-top:1rem;
  background:#0b3c5d;
  color:#fff;
  padding:0.6rem 1.2rem;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:600;
}
button:hover { background:#06293f; }

table { width:100%; border-collapse:collapse; margin-top:1.5rem; }
th, td { padding:10px; border-bottom:1px solid #ddd; }
th { background:#e3eef7; }

.delete-btn {
  background:#e53935;
  color:#fff;
  border:none;
  padding:6px 10px;
  border-radius:5px;
  cursor:pointer;
}
.delete-btn:hover { background:#c62828; }
</style>
</head>

<body>

<header>
  <h1>Exam Ring — Mentor Dashboard</h1>
</header>

<main>

<h2>Post New Exam</h2>

<label>Year</label>
<select id="year">
  <option value="">Select Year</option>
  <option value="1">1st Year</option>
  <option value="2">2nd Year</option>
  <option value="3">3rd Year</option>
  <option value="4">4th Year</option>
</select>

<label>Branch</label>
<select id="branch">
  <option value="">Select Branch</option>
  <option value="CSE">CSE</option>
  <option value="IT">IT</option>
  <option value="AIML">AIML</option>
  <option value="DS">DS</option>
</select>

<label>Section</label>
<select id="section">
  <option value="">Select Section</option>
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
</select>

<label>Exam Name</label>
<input id="examName" placeholder="Mid Term Exam">

<label>Subject</label>
<input id="subject" placeholder="Mathematics">

<label>Date</label>
<input type="date" id="date">

<label>Room and some Discriptions</label>
<input id="room" placeholder="101">
 
<button onclick="postExam()">Post Exam</button>

<h2>Upcoming Exams</h2>

<table>
<thead>
<tr>
  <th>Exam</th>
  <th>Subject</th>
  <th>Date</th>
  <th>Room</th>
  <th>Class</th>
  <th>Action</th>
</tr>
</thead>
<tbody id="examTable">
<tr><td colspan="6" style="text-align:center">Loading...</td></tr>
</tbody>
</table>

</main>

<script>
/* FETCH EXAMS */
async function fetchExams(){
  const tbody = document.getElementById("examTable");
  const res = await fetch("https://college-hwbb.onrender.com/api/exams");
  const data = await res.json();

  tbody.innerHTML = "";

  if(!data.success || data.exams.length === 0){
    tbody.innerHTML = "<tr><td colspan='6' style='text-align:center'>No exams</td></tr>";
    return;
  }

  data.exams.forEach(e=>{
    tbody.innerHTML += `
      <tr>
        <td>${e.examName}</td>
        <td>${e.subject}</td>
        <td>${e.date}</td>
        <td>${e.room}</td>
        <td>${e.class}</td>
        <td><button class="delete-btn" onclick="deleteExam('${e.examId}')">Delete</button></td>
      </tr>
    `;
  });
}

/* POST EXAM */
async function postExam(){
  const y = year.value;
  const b = branch.value;
  const s = section.value;

  if(!y || !b || !s){
    alert("Please select Year, Branch & Section");
    return;
  }

  const rawClass = `${y}${b}${s}`;

  const payload = {
    examName: examName.value.trim(),
    subject: subject.value.trim(),
    date: date.value,
    room: room.value.trim(),
    class: rawClass
  };

  if(Object.values(payload).some(v => !v)){
    alert("Fill all fields");
    return;
  }

  const res = await fetch("https://college-hwbb.onrender.com/api/exams",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(payload)
  });

  const data = await res.json();
  if(data.success){
    alert("Exam posted");
    document.querySelectorAll("input").forEach(i=>i.value="");
    document.querySelectorAll("select").forEach(s=>s.value="");
    fetchExams();
  } else {
    alert(data.message || "Error");
  }
}

/* DELETE */
async function deleteExam(id){
  if(!confirm("Delete this exam?")) return;
  const res = await fetch(`https://college-hwbb.onrender.com/api/exams/${id}`,{method:"DELETE"});
  const data = await res.json();
  if(data.success) fetchExams();
}

fetchExams();
</script>

</body>
</html>
